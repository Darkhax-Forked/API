- hosts: apiservers
  tasks:
    - name: copies the jar file over
      copy: src={{item}} dest=/var/www/devapi.diluv.com/API.jar
      with_fileglob:
        - build/libs/*.jar

    - name: copies the docker file over
      copy: src=Dockerfile dest=/var/www/devapi.diluv.com/Dockerfile

    - name: stop docker
      command: docker-compose down
      args:
          chdir: /var/www/devapi.diluv.com/

    - name: run docker
      command: docker-compose up --build -d
      args:
          chdir: /var/www/devapi.diluv.com/